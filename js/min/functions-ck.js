/////////////////////////////////
//	Core functionality
/////////////////////////////////
function init(){$("shotContainer").ontouchmove=function(a){a.preventDefault()};if(shotID==""){getShot();var a=$("#getShotButton").bind("webkitAnimationEnd",function(){this.style.webkitAnimationName=""}),a=$("#shotButtonShadow").bind("webkitAnimationEnd",function(){this.style.webkitAnimationName=""})}}function reloadGetShot(){getShot()}function getShot(){$("#getShotButton").css("webkitAnimationDuration","0.5s");$("#getShotButton").css("webkitAnimationName","bounceBall");$("#shotButtonShadow").css("webkitAnimationName","ballShadow");shotID="";for(i=0;i<6;i++){if(i==0)var a=Math.floor(Math.random()*5).toString();else var a=Math.floor(Math.random()*10).toString();shotID+=a}var b="http://api.dribbble.com/shots/"+shotID;$.ajax({dataType:"jsonp",url:b,type:"GET",timeout:750,error:function(){reloadGetShot()},success:function(a){$("#getShotButton").css("webkitAnimationDuration","1.5s");$("#getShotButton").css("webkitAnimationName","shootBall");playerID=a.player.id;getShotComments();getPlayerProfile();$("#shotImageLink").attr("href",a.url);$("#shotImage").css("background-image","url("+a.image_url+")");$("#shotImage").css("width",a.width+"px");$("#shotImage").css("height",a.height+"px");$("#shotImage").css("margin-top",90+(150-a.height/2)+"px");$("#shotImage").css("margin-left",-(a.width/2)+"px");$("#shotTitle").text(a.title);$("#shotPlayer").text(a.player.name)}})}function getShotComments(){var a="http://api.dribbble.com/shots/"+shotID+"/comments";$.ajax({dataType:"jsonp",url:a,type:"GET",success:function(b){var c=[];b.total==0?c.push('<h4 id="noCommentsNotice">No comments.</h4>'):b.pages<=1?$.each(b.comments,function(a,b){c.push('<div class="comment">');c.push('<a href="'+b.player.url+'"><img class="commenterAvatar" src="'+b.player.avatar_url+'"></a>');c.push('<h3 class="commenterName">'+b.player.name+"</h3><br>");c.push('<p class="commentBody">'+b.body+"</p>");c.push("</div>")}):getMultiPageComments(a);$("#shotComments").html(c.join(""));$("#toggleShotCommentsButton").text(b.total)}})}function getMultiPageComments(a){var b=a+"?page=",c=[];for(i=1;i<=shot.pages;i++){alert(b+i);$.ajax({dataType:"jsonp",url:b+i,type:"GET",success:function(a){$.each(a.comments,function(a,b){c.push('<div class="comment">');c.push('<a href="'+b.player.url+'"><img class="commenterAvatar" src="'+b.player.avatar_url+'"></a>');c.push('<h3 class="commenterName">'+b.player.name+"</h3><br>");c.push('<p class="commentBody">'+b.body+"</p>");c.push("</div>")})}})}$("#shotComments").html(c.join(""))}function getPlayerProfile(){var a="http://api.dribbble.com/players/"+playerID,b="http://api.dribbble.com/players/"+playerID+"/shots",c=[];$.ajax({dataType:"jsonp",url:a,type:"GET",success:function(a){c.push('<a href="'+a.url+'"><img id="playerProfileAvatar" src="'+a.avatar_url+'"></a>');c.push('<h3 id="playerProfileName">'+a.name+"</h3><br>");c.push('<span id="latestShotsSpan">Latest shots:</span>')}});$.ajax({dataType:"jsonp",url:b,type:"GET",success:function(a){c.push('<div id="playerProfileShots">');for(i=0;i<=8;i++){var b=a.shots[i];c.push('<a href="'+b.url+'"><img class="shotPreview" src="'+b.image_url+'"></a>')}c.push("</div>");$("#playerProfile").html(c.join(""))}})}function toggleShotComments(){if(commentsShown===!1){$("#background_bottom").css("webkitAnimationName","openCommentsDrawer");commentsShown=!0}else{$("#background_bottom").css("webkitAnimationName","closeCommentsDrawer");commentsShown=!1}}function toggleProfile(){if(profileShown===!1){$("#playerProfile").css("webkitAnimationName","profileOpen");profileShown=!0}else{$("#playerProfile").css("webkitAnimationName","profileClose");profileShown=!1}}var shotID="",playerID="",commentsShown=!1,profileShown=!1;