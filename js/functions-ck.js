/////////////////////////////////
//	Initial setup
/////////////////////////////////
function init(){if(!navigator.standalone){$("body").css("width",$(window).width());$("body").css("height",$(window).height());$("#promo").css("width",$(window).width());$("#promo").css("height",$(window).height());$("#promo").css("display","block");$("#container").css("display","none")}else{$("#promo").css("display","none");$("#container").css("display","block");$("#container").width()>=$("#container").height()?landscapeViewport=!0:landscapeViewport=!1;var a=document.URL,b=a.substring(a.indexOf("?")+1,a.length);getShot(b);var c=$("#getShotButton").bind("webkitAnimationEnd",function(){this.style.webkitAnimationName=""}),c=$("#shotButtonShadow").bind("webkitAnimationEnd",function(){this.style.webkitAnimationName=""});if(typeof window.DeviceMotionEvent!="undefined"){var d=25,e=0,f=0,g=0,h=0,i=0,j=0;window.addEventListener("devicemotion",function(a){e=a.accelerationIncludingGravity.x;f=a.accelerationIncludingGravity.y;g=a.accelerationIncludingGravity.z},!1);setInterval(function(){var a=Math.abs(e-h+f-i+g-j);a>d&&getShot();h=e;i=f;j=g},150)}}}function boo(){var a="http://maxsteenbergen.com/longshot?"+globalShotID;switch(window.orientation){case 0:window.location.href=a;break;case-90:window.location.href=a;break;case 90:window.location.href=a}}function reloadGetShot(){getShot()}function getShot(a){var b=window.navigator.onLine;if(!b||errorCounter>=15){$("#noConnectionModal").css("display","block");errorCounter=0}else{$("#shotImage").css("webkitAnimationName","fadeOut");$("#titleAndName").css("webkitAnimationName","fadeOut");$("#noConnectionModal").css("display","none");$("#getShotButton").css("webkitAnimationDuration","0.5s");$("#getShotButton").css("webkitAnimationName","bounceBall");$("#shotButtonShadow").css("webkitAnimationName","ballShadow");var c="";if(a==undefined||a=="")for(i=0;i<6;i++){if(i==0)var d=Math.floor(Math.random()*5).toString();else var d=Math.floor(Math.random()*10).toString();c+=d}else c=a;var e="http://api.dribbble.com/shots/"+c;$.ajax({dataType:"jsonp",url:e,type:"GET",timeout:750,error:function(){reloadGetShot();errorCounter++},success:function(a){errorCounter=0;playerID=a.player.id;$("#shotImageLink").attr("href",a.url);$("#shotImage").css("background-image","url("+a.image_url+")");$("#shotImage").css("width",a.width+"px");$("#shotImage").css("height",a.height+"px");$("#shotImage").css("margin-top",90+(150-a.height/2)+"px");$("#shotImage").css("margin-left",-(a.width/2)+"px");$("#shotTitle").text(a.title);$("#shotPlayer").text(a.player.name);var b="https://twitter.com/share?text=Check out this awesome shot by @"+a.player.twitter_screen_name+" on @dribbble!&url="+a.short_url;$("#tweetButton").attr("href",b);var d=encodeURIComponent(a.short_url),e="http://www.facebook.com/sharer.php?u="+d;$("#fbButton").attr("href",e);getShotComments(c);getPlayerProfile();$("#shotImage").css("webkitAnimationName","fadeIn");$("#titleAndName").css("webkitAnimationName","fadeIn")}});globalShotID=c}}function getShotComments(a){var b="http://api.dribbble.com/shots/"+a+"/comments?per_page=30";$.ajax({dataType:"jsonp",url:b,type:"GET",success:function(a){var b=[];$("#toggleShotCommentsButton").text(a.total);if(a.total==0){b.push('<h4 id="noCommentsNotice">No comments.</h4>');$("#shotComments").html(b.join(""))}else{$.each(a.comments,function(a,c){b.push('<div class="comment">');b.push('<a href="'+c.player.url+'"><img class="commenterAvatar" src="'+c.player.avatar_url+'"></a>');b.push('<h3 class="commenterName">'+c.player.name+"</h3><br>");b.push('<p class="commentBody">'+c.body+"</p>");b.push("</div>")});$("#shotComments").html(b.join(""))}}})}function getPlayerProfile(){var a="http://api.dribbble.com/players/"+playerID,b="http://api.dribbble.com/players/"+playerID+"/shots",c=[];$.ajax({dataType:"jsonp",url:a,type:"GET",success:function(a){c.push('<a href="'+a.url+'"><img id="playerProfileAvatar" src="'+a.avatar_url+'"></a>');c.push('<h3 id="playerProfileName">'+a.name+"</h3><br>");c.push('<span id="latestShotsSpan">Latest shots:</span>')}});$.ajax({dataType:"jsonp",url:b,type:"GET",success:function(a){c.push('<div id="playerProfileShots">');for(i=0;i<=11;i++){var b=a.shots[i];c.push('<img class="shotPreview" onclick="getShot('+b.id+'); toggleProfile();" src="'+b.image_url+'">')}c.push("</div>");$("#playerProfile").html(c.join(""))}})}function getStreamShots(a){a=="popular"?$("#streamTitle").html("Popular Shots"):$("#streamTitle").html("Latest Shots");var b=[],c="http://api.dribbble.com/shots/"+a+"?per_page=30";$.ajax({dataType:"jsonp",url:c,type:"GET",error:function(){alert("fail")},success:function(a){var c=0;landscapeViewport==1?c=7:c=8;for(i=0;i<=c;i++){var d=a.shots[i];b.push('<div class="streamShot" onclick="getShot('+d.id+'); togglePages();" style="background-image: url('+d.image_teaser_url+')">');b.push("<h3>"+d.title+"</h3>");b.push("<h4>"+d.player.name+"</h4>");b.push("</div>")}$("#shotsStream").html(b.join(""))}});if(!streamPageShown){togglePages(a);currentPage=a}}function toggleShotComments(){if($("#container").width()<=640)if(commentsShown==0){$("#background_bottom").css("webkitAnimationName","openCommentsDrawer");$("#tweetButton").css("webkitAnimationName","openCommentsDrawer");$("#fbButton").css("webkitAnimationName","openCommentsDrawer");commentsShown=!0}else{$("#background_bottom").css("webkitAnimationName","closeCommentsDrawer");$("#tweetButton").css("webkitAnimationName","closeCommentsDrawer");$("#fbButton").css("webkitAnimationName","closeCommentsDrawer");commentsShown=!1}else if(commentsShown==0){$("#imageContainer").css("webkitAnimationName","scrollToComments");commentsShown=!0}else{$("#imageContainer").css("webkitAnimationName","scrollToShot");commentsShown=!1}}function toggleProfile(){if(profileShown==0){$("#playerProfile").css("webkitAnimationName","profileOpen");profileShown=!0}else{$("#playerProfile").css("webkitAnimationName","profileClose");profileShown=!1}}function togglePages(a){var b="";if(streamPageShown==0){$("#shotsStreamPage").css("display","block");$("#shotsStreamPage").css("webkitAnimationName","slidePageLeft");$("#backButton").css("webkitAnimationName","slideBackButtonIn");$("#mainPageControls").css("webkitAnimationName","slideMainPageControlsOut");streamPageShown=!0}else{$("#shotsStreamPage").css("webkitAnimationName","slidePageRight");$("#backButton").css("webkitAnimationName","slideBackButtonOut");$("#mainPageControls").css("webkitAnimationName","slideMainPageControlsIn");setTimeout(function(){$("#shotsStreamPage").css("display","none")},500);streamPageShown=!1}}var globalShotID="",playerID="",commentsShown=!1,profileShown=!1,streamPageShown=!1,currentPage="main",landscapeViewport=!1,errorCounter=0;